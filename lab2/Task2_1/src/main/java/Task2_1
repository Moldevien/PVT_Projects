
--create database Cafe

-- Клієнти
create table clients (
    id serial primary key,
    first_name varchar(30) not null,
    last_name varchar(30) not null,
    birth_date date,
    phone varchar(13),
    mail varchar(100) not null,
    discount numeric(4,2) default 0 check (discount between 0 and 100)
);

-- Тип продукту
create table product_types (
    id serial primary key,
    name varchar(30) not null
);

-- Товар
create table products (
    id serial primary key,
    name_ua varchar(100) not null,
    name_en varchar(100) not null,
    price numeric(6,2) not null,
    type_id int references product_types(id) on delete set null
);

-- Позиція
create table positions (
    id serial primary key,
    name varchar(30) not null
);

-- Персонал
create table staff (
    id serial primary key,
    first_name varchar(30) not null,
    last_name varchar(30) not null,
    phone varchar(13) not null,
    mail varchar(100) not null,
    position_id int references positions(id) on delete set null
);

-- Графік роботи
create table staff_schedule (
    id serial primary key,
    staff_id int references staff(id) on delete set null,
    work_date date not null
);

-- Замовлення
create table orders (
    id serial primary key,
    client_id int references clients(id) on delete set null,
    staff_id int references staff(id) on delete set null,
    order_date timestamp default current_timestamp
);

-- Товар-замовлення
create table order_products (
    id serial primary key,
    order_id int references orders(id) on delete cascade,
    product_id int references products(id) on delete set null,
    quantity int default 1 check (quantity > 0)
);

insert into positions (name)
values ('Бариста'), ('Офіціант'), ('Кондитер');

insert into product_types (name)
values ('Десерт'), ('Напій');